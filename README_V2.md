# M3U8 ä¸‹è½½å™¨ - v2.0

> ğŸš€ **v2.0 ç‰ˆæœ¬é‡å¤§å‡çº§ï¼šä½¿ç”¨ FFmpeg è¿›è¡Œä¸“ä¸šçº§è§†é¢‘åˆå¹¶ï¼Œç”Ÿæˆæ ‡å‡† MP4 æ ¼å¼**

golang å¤šçº¿ç¨‹ä¸‹è½½ç›´æ’­æµm3u8æ ¼å¼çš„è§†é¢‘ï¼Œè·¨å¹³å°ã€‚ä½ åªéœ€æŒ‡å®šå¿…è¦çš„å‚æ•°æ¥è¿è¡Œï¼Œå·¥å…·å°±ä¼šè‡ªåŠ¨å¸®ä½ è§£æ M3U8 æ–‡ä»¶ï¼Œå¹¶å°† TS ç‰‡æ®µä¸‹è½½ä¸‹æ¥åˆå¹¶æˆ MP4 æ–‡ä»¶ã€‚

---

## âœ¨ v2.0 æ–°ç‰¹æ€§

- ğŸ¬ **ä½¿ç”¨ FFmpeg åˆå¹¶** - ç”Ÿæˆæ ‡å‡† MP4 æ ¼å¼ï¼Œè€Œä¸æ˜¯ç®€å•çš„ TS æµæ‹¼æ¥
- ğŸ“Š **æ”¹è¿›çš„è¿›åº¦æ˜¾ç¤º** - æ˜¾ç¤ºå®æ—¶ä¸‹è½½é€Ÿåº¦å’Œ ETAï¼ˆå‰©ä½™æ—¶é—´ï¼‰ï¼Œä¾‹å¦‚ï¼š`25.5 files/s ETA: 20s`
- ğŸ”„ **æ™ºèƒ½é‡è¯•æœºåˆ¶** - æŒ‡æ•°é€€é¿ç®—æ³•ï¼Œæ›´å¥½çš„ç½‘ç»œå®¹é”™èƒ½åŠ›
- âš¡ **å¹¶å‘å®‰å…¨** - ä½¿ç”¨åŸå­æ“ä½œï¼Œç¡®ä¿å¤šçº¿ç¨‹ä¸‹è½½è®¡æ•°å‡†ç¡®
- ğŸ›¡ï¸ **å¢å¼ºçš„é”™è¯¯å¤„ç†** - å®Œæ•´çš„å‚æ•°éªŒè¯ã€ä¾èµ–æ£€æŸ¥å’Œæ—¥å¿—è®°å½•
- ğŸ“ **ä¼˜è´¨æ—¥å¿—** - æ¸…æ™°çš„é”™è¯¯æç¤ºå’Œè°ƒè¯•ä¿¡æ¯

**è¯¦ç»†æ”¹è¿›è¯´æ˜:** [ä¼˜åŒ–æ–‡æ¡£](./IMPROVEMENTS.md) | [ä»£ç å¯¹æ¯”](./CODE_COMPARISON.md)

---

## ğŸ¯ ä¸»è¦åŠŸèƒ½

1. âœ… ä¸‹è½½å’Œè§£æ M3U8 æ–‡ä»¶
2. âœ… å¤šçº¿ç¨‹å¹¶å‘ä¸‹è½½ TS ç‰‡æ®µ
3. âœ… è‡ªåŠ¨åŠ å¯†è§£å¯†ï¼ˆAES-128-CBCï¼‰
4. âœ… **ä½¿ç”¨ FFmpeg åˆå¹¶ä¸º MP4**ï¼ˆæ–°å¢ v2.0ï¼‰
5. âœ… æ˜¾ç¤ºä¸‹è½½é€Ÿåº¦å’Œ ETA
6. âœ… å®Œæ•´çš„æ–­ç‚¹ç»­ä¼ å’Œå¤±è´¥é‡è¯•

> å¯ä»¥ä¸‹è½½å„ç§ç›´æ’­æµè§†é¢‘  
> å¯ä»¥ä¸‹è½½å„ç§ç›´æ’­æµè§†é¢‘  
> å¯ä»¥ä¸‹è½½å„ç§ç›´æ’­æµè§†é¢‘  
> é‡è¦çš„äº‹æƒ…è¯´ä¸‰é

## æ•ˆæœå±•ç¤º
![demo](./demo.gif)

---

## ğŸ“‹ å‚æ•°è¯´æ˜

```
å¿…éœ€å‚æ•°:
  -u string
        m3u8 ä¸‹è½½åœ°å€ (http(s)://url/xx/xx/index.m3u8)

å¯é€‰å‚æ•°:
  -o string
        è¾“å‡ºæ–‡ä»¶åï¼Œä¸å¸¦åç¼€ (é»˜è®¤ "movie")
  
  -n int
        å¹¶å‘ä¸‹è½½çº¿ç¨‹æ•° (é»˜è®¤ 24ï¼Œå»ºè®® 16-32)
  
  -ht string
        Host ç±»å‹è®¾ç½® (é»˜è®¤ "v1")
        v1: http(s)://host + è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†
        v2: http(s)://hostï¼ˆæŸäº›æœåŠ¡å™¨éœ€è¦ï¼‰
  
  -c string
        è‡ªå®šä¹‰è¯·æ±‚ Cookie (ä¾‹å¦‚: "key1=v1; key2=v2")
  
  -r bool
        æ˜¯å¦è‡ªåŠ¨æ¸…é™¤ä¸‹è½½çš„ ts æ–‡ä»¶ (é»˜è®¤ true)
  
  -s int
        æ˜¯å¦å…è®¸ä¸å®‰å…¨çš„ https è¯·æ±‚ (é»˜è®¤ 0)
  
  -sp string
        æ–‡ä»¶ä¿å­˜çš„ç»å¯¹è·¯å¾„ (é»˜è®¤å½“å‰ç›®å½•)
```

### ä½¿ç”¨ç¤ºä¾‹

```bash
# æœ€ç®€å•çš„ç”¨æ³•
./m3u8-downloader -u "http://example.com/index.m3u8"

# æŒ‡å®šè¾“å‡ºåç§°å’Œçº¿ç¨‹æ•°
./m3u8-downloader -u "http://example.com/index.m3u8" -o "my_video" -n 32

# ä¸‹è½½å¤±è´¥æ—¶å°è¯• v2 æ¨¡å¼
./m3u8-downloader -u "http://example.com/index.m3u8" -ht v2

# æŒ‡å®šä¿å­˜è·¯å¾„
./m3u8-downloader -u "http://example.com/index.m3u8" -sp "/home/user/videos"

# è‡ªå®šä¹‰ Cookieï¼ˆæŸäº›æœåŠ¡å™¨éœ€è¦ï¼‰
./m3u8-downloader -u "http://example.com/index.m3u8" -c "session_id=abc123xyz"

# å®Œæ•´ç¤ºä¾‹
./m3u8-downloader -u "http://example.com/video.m3u8" \
  -o "my_movie" \
  -n 32 \
  -ht v1 \
  -c "key1=v1; key2=v2" \
  -sp "/path/to/save"
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬1æ­¥ï¼šå®‰è£…ä¾èµ–

#### å®‰è£… Go 1.16+
- è®¿é—® https://golang.org/dl/
- ä¸‹è½½åˆé€‚çš„ç‰ˆæœ¬å¹¶å®‰è£…
- éªŒè¯ï¼š`go version`

#### å®‰è£… FFmpegï¼ˆå¿…éœ€ï¼‰

**macOS:**
```bash
brew install ffmpeg
```

**Ubuntu/Debian:**
```bash
sudo apt-get install ffmpeg
```

**CentOS/RHEL:**
```bash
sudo yum install ffmpeg
```

**Windows:**
- è®¿é—® https://ffmpeg.org/download.html
- æŒ‰ç…§è¯´æ˜ä¸‹è½½å¹¶å®‰è£…
- å°† ffmpeg æ·»åŠ åˆ°ç³»ç»Ÿ PATH

éªŒè¯å®‰è£…ï¼š
```bash
ffmpeg -version
```

### ç¬¬2æ­¥ï¼šç¼–è¯‘ç¨‹åº

**ä½¿ç”¨ç¼–è¯‘è„šæœ¬ï¼ˆæ¨èï¼‰ï¼š**
```bash
chmod +x build.sh
./build.sh
```

**æ‰‹åŠ¨ç¼–è¯‘ï¼š**
```bash
go build -o m3u8-downloader m3u8-downloader.go
```

### ç¬¬3æ­¥ï¼šè¿è¡Œç¨‹åº

```bash
./m3u8-downloader -u "http://example.com/index.m3u8"
```

ç¨‹åºä¼šè‡ªåŠ¨ç”Ÿæˆ `movie.mp4` æ–‡ä»¶åˆ°å½“å‰ç›®å½•ã€‚

---

## ğŸ“¥ é¢„ç¼–è¯‘äºŒè¿›åˆ¶ä¸‹è½½

ä» [GitHub Releases](https://github.com/llychao/m3u8-downloader/releases) ä¸‹è½½å·²ç¼–è¯‘çš„ç‰ˆæœ¬ï¼š

- `m3u8-darwin-amd64` - macOS (Intel)
- `m3u8-darwin-arm64` - macOS (Apple Silicon)
- `m3u8-linux-386` - Linux (32-bit)
- `m3u8-linux-amd64` - Linux (64-bit)
- `m3u8-linux-arm64` - Linux (ARM)
- `m3u8-windows-386.exe` - Windows (32-bit)
- `m3u8-windows-amd64.exe` - Windows (64-bit)
- `m3u8-windows-arm64.exe` - Windows (ARM)

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# Linux/macOS
chmod +x m3u8-linux-amd64
./m3u8-linux-amd64 -u "http://example.com/index.m3u8"

# Windows PowerShell
.\m3u8-windows-amd64.exe -u "http://example.com/index.m3u8"
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ 1ï¼š`ffmpeg: command not found`

**åŸå› ï¼š** ç³»ç»Ÿæœªå®‰è£… FFmpeg

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# macOS
brew install ffmpeg

# Linux
sudo apt-get install ffmpeg

# éªŒè¯
ffmpeg -version
```

### é—®é¢˜ 2ï¼šä¸‹è½½å¤±è´¥æˆ–æ— æ³•è¿æ¥

**å¯èƒ½åŸå› ï¼š**
1. URL åœ°å€é”™è¯¯
2. ç½‘ç»œè¿æ¥é—®é¢˜
3. Host ç±»å‹ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# å°è¯•ä½¿ç”¨ -ht v2 å‚æ•°
./m3u8-downloader -u "http://example.com/index.m3u8" -ht v2

# å‡å°‘çº¿ç¨‹æ•°ï¼ˆæŸäº›æœåŠ¡å™¨å¯èƒ½é™åˆ¶ï¼‰
./m3u8-downloader -u "http://example.com/index.m3u8" -n 16

# æ·»åŠ  Cookieï¼ˆå¦‚æœæœåŠ¡å™¨è¦æ±‚ï¼‰
./m3u8-downloader -u "http://example.com/index.m3u8" -c "your_cookie"
```

### é—®é¢˜ 3ï¼šåˆå¹¶å¤±è´¥æˆ–è¾“å‡ºæ— æ³•æ’­æ”¾

**å¯èƒ½åŸå› ï¼š**
1. ts æ–‡ä»¶ä¸‹è½½ä¸å®Œæ•´
2. FFmpeg ç‰ˆæœ¬è¿‡ä½
3. ç£ç›˜ç©ºé—´ä¸è¶³

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# é‡æ–°ä¸‹è½½ï¼ˆæ–­ç‚¹ç»­ä¼ ä¼šè·³è¿‡å·²ä¸‹è½½çš„æ–‡ä»¶ï¼‰
./m3u8-downloader -u "http://example.com/index.m3u8" -o "my_video"

# å‡çº§ FFmpeg
brew upgrade ffmpeg  # macOS
sudo apt-get install --only-upgrade ffmpeg  # Linux

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æ£€æŸ¥è¾“å‡ºæ–‡ä»¶
ffmpeg -i output.mp4
```

### é—®é¢˜ 4ï¼šè¿›åº¦æ¡å¡ä½æˆ–ä¸‹è½½åœæ­¢

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# 1. åœæ­¢ç¨‹åºï¼ˆCtrl+Cï¼‰
# 2. é‡æ–°è¿è¡Œç›¸åŒçš„å‘½ä»¤ï¼Œç¨‹åºä¼šè‡ªåŠ¨è·³è¿‡å·²ä¸‹è½½çš„æ–‡ä»¶
# 3. å¦‚æœé—®é¢˜æŒç»­ï¼Œå‡å°‘çº¿ç¨‹æ•°
./m3u8-downloader -u "http://example.com/index.m3u8" -n 8
```

---

## ğŸ“Š è¿›åº¦æ¡ç¤ºä¾‹

```
========================================
     M3U8 è§†é¢‘ä¸‹è½½å·¥å…· v2.0
=========================================

[Downloading] â– â– â– â– â–  50.00% (500/1000) 25.5 files/s ETA: 20s
[Info] å¼€å§‹ä½¿ç”¨ FFmpeg åˆå¹¶è§†é¢‘...
[Merging] â– â– â– â– â– â– â– â– â– â–  100.00%
[Success] ä¸‹è½½ä¿å­˜è·¯å¾„ï¼š/path/to/movie.mp4
å…±è€—æ—¶: 45.32s
```

---

## ğŸ” å®‰å…¨æ€§æ³¨æ„

- **ä¸æ”¶é›†ä»»ä½•æ•°æ®** - å®Œå…¨æœ¬åœ°è¿è¡Œï¼Œä¸è¿æ¥ç¬¬ä¸‰æ–¹æœåŠ¡
- **å¼€æºä»£ç ** - æ‰€æœ‰æºä»£ç å¯å®¡è®¡
- **æ”¯æŒåŠ å¯†** - è‡ªåŠ¨å¤„ç† AES-128-CBC åŠ å¯†çš„ TS æ–‡ä»¶
- **ä¸æ”¯æŒ DRM** - å— DRM ä¿æŠ¤çš„å†…å®¹æ— æ³•ä¸‹è½½

---

## ğŸ› åé¦ˆå’Œè´¡çŒ®

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿ï¼š
- æäº¤ Issue
- æäº¤ Pull Request
- åé¦ˆä½¿ç”¨ä½“éªŒ

---

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](./LICENSE) æ–‡ä»¶

---

## ç‰ˆæœ¬å†å²

### v2.0 (2026-02-06)
- âœ¨ æ–°å¢ FFmpeg è§†é¢‘åˆå¹¶åŠŸèƒ½
- ğŸ“Š æ”¹è¿›è¿›åº¦æ˜¾ç¤ºï¼ˆæ˜¾ç¤ºé€Ÿåº¦å’Œ ETAï¼‰
- ğŸ”„ ä¼˜åŒ–é‡è¯•æœºåˆ¶ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
- âš¡ ä½¿ç”¨åŸå­æ“ä½œç¡®ä¿çº¿ç¨‹å®‰å…¨
- ğŸ›¡ï¸ å¢å¼ºé”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- ğŸ“ å®Œæ•´çš„å‚æ•°éªŒè¯

### v1.0
- åŸºç¡€ä¸‹è½½å’ŒäºŒè¿›åˆ¶åˆå¹¶åŠŸèƒ½

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
